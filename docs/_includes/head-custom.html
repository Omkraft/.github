<script type="module">
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

  mermaid.initialize({
    startOnLoad: false,
    theme: "base",
    themeVariables: {
        /* Omkraft brand */
        primaryColor: "#3A98F1",
        primaryBorderColor: "#05004E",
        lineColor: "#05004E",

        /* ðŸ”‘ TEXT COLORS (FIX) */
        primaryTextColor: "#05004E",
        nodeTextColor: "#05004E",
        edgeLabelColor: "#05004E",
        clusterTextColor: "#05004E",

        /* Flowchart specifics */
        clusterBorder: "#05004E",
        clusterBkg: "#F6F9FF",
        edgeLabelBackground: "#ffffff",

        /* Typography */
        fontFamily:
            "-apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif",
        fontSize: "14px"
    }
  });

  document.addEventListener("DOMContentLoaded", () => {
    const blocks = document.querySelectorAll("pre code.language-mermaid");
    if (!blocks.length) return;

    mermaid.run({ nodes: blocks });

    // ðŸ”’ FINAL, GUARANTEED CENTERING
    requestAnimationFrame(() => {
      document.querySelectorAll("pre").forEach(pre => {
        if (pre.querySelector("svg")) {
          pre.style.textAlign = "center";

          const svg = pre.querySelector("svg");
          if (svg) {
            svg.style.display = "inline-block";
            svg.style.maxWidth = "100%";
          }
        }
      });
    });
  });
</script>
